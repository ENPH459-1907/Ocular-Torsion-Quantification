
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ota.gui.torsion_application &#8212; Ocular-Torsion-Quantification 1.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for ota.gui.torsion_application</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># UI</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">tkinter.filedialog</span> <span class="k">import</span> <span class="n">askopenfilename</span><span class="p">,</span> <span class="n">askdirectory</span><span class="p">,</span> <span class="n">asksaveasfile</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;TkAgg&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">FigureCanvasTkAgg</span><span class="p">,</span> <span class="n">NavigationToolbar2TkAgg</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="k">import</span> <span class="n">Figure</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="k">import</span> <span class="n">plot</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">plotly.tools</span> <span class="k">as</span> <span class="nn">tools</span>
<span class="kn">from</span> <span class="nn">plotly.colors</span> <span class="k">import</span> <span class="n">DEFAULT_PLOTLY_COLORS</span>

<span class="c1"># OTA tools</span>
<span class="kn">from</span> <span class="nn">ota.gui</span> <span class="k">import</span> <span class="n">coord_click</span> <span class="k">as</span> <span class="n">clk</span>
<span class="kn">from</span> <span class="nn">ota.gui</span> <span class="k">import</span> <span class="n">frame_scroll</span> <span class="k">as</span> <span class="n">scroll</span>
<span class="kn">from</span> <span class="nn">ota.video</span> <span class="k">import</span> <span class="n">video</span> <span class="k">as</span> <span class="n">vid</span>
<span class="kn">from</span> <span class="nn">ota.execution</span> <span class="k">import</span> <span class="n">pupil_locate</span> <span class="k">as</span> <span class="n">pl</span>
<span class="kn">from</span> <span class="nn">ota.execution</span> <span class="k">import</span> <span class="n">torsion_quant_2DX</span> <span class="k">as</span> <span class="n">tq2dx</span>
<span class="kn">from</span> <span class="nn">ota.eyelid</span> <span class="k">import</span> <span class="n">eyelid</span>
<span class="kn">from</span> <span class="nn">ota.data</span> <span class="k">import</span> <span class="n">data</span> <span class="k">as</span> <span class="n">dat</span>
<span class="kn">from</span> <span class="nn">ota.iris</span> <span class="k">import</span> <span class="n">iris</span><span class="p">,</span> <span class="n">eyelid_removal</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="k">import</span> <span class="n">tqdm</span>


<span class="n">LARGE_FONT</span><span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Verdana&quot;</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>

<div class="viewcode-block" id="OcularTorsionApplication"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication">[docs]</a><span class="k">class</span> <span class="nc">OcularTorsionApplication</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Object that allows the user to interface with multiple torsion quantification methods.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        video: video object</span>
<span class="sd">        start_frame: integer</span>
<span class="sd">        reference_frame: reference frame from which torsion is measured</span>
<span class="sd">        end_frame: integer</span>
<span class="sd">        save_path: string, local directory location to save results to</span>
<span class="sd">        pupil_list: dictionary of pupil objects</span>
<span class="sd">                    key: (int) video frame</span>
<span class="sd">                    value: pupil object</span>
<span class="sd">        eyelid_list: dictionary of eyelid objects</span>
<span class="sd">                     key: (int) video frame</span>
<span class="sd">                     value: eyelid object</span>
<span class="sd">        torsion: a list that holds iris rotations results</span>
<span class="sd">        frame: dictionary that holds the pages of the GUI</span>
<span class="sd">               key: (str) name of the frame</span>
<span class="sd">               value: GUI page</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a torsion application object</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">container</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">grid_rowconfigure</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">container</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Values that are common to all torsion methods</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polar_transform_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pupil_threshold</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Dictionary to store all the frames (pages) in the UI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frames</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">F</span> <span class="ow">in</span> <span class="p">(</span><span class="n">StartPage</span><span class="p">,</span> <span class="n">MeasureTorsion</span><span class="p">):</span>

            <span class="n">frame</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">container</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="n">F</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame</span>

            <span class="n">frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;nsew&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">show_frame</span><span class="p">(</span><span class="n">StartPage</span><span class="p">)</span>

<div class="viewcode-block" id="OcularTorsionApplication.run"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measure_state</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Runs the 2D correlation algorithm based on GUI state and common values.</span>

<span class="sd">        Input:</span>
<span class="sd">            measure_state: current state of measurement page of the GUI</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Extract required values from GUI page</span>
        <span class="n">RADIUS</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">RESOLUTION</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="c1"># Determine whether interpolation or upsampling should be used</span>
        <span class="c1"># Default to interpolation</span>
        <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">torsion_mode</span> <span class="o">=</span> <span class="s1">&#39;interp&#39;</span>
        <span class="k">elif</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Upsampling</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">torsion_mode</span> <span class="o">=</span> <span class="s1">&#39;upsample&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">torsion_mode</span> <span class="o">=</span> <span class="s1">&#39;interp&#39;</span>

        <span class="c1"># Determine if the user desires locations of the reference frame to be replaced by noise</span>
        <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">NoiseReplacement</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="n">replace_status</span> <span class="o">=</span> <span class="s1">&#39;noise_replace&#39;</span>
            <span class="n">upper_iris</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">upper_iris_occ</span>
            <span class="n">lower_iris</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">lower_iris_occ</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">replace_status</span> <span class="o">=</span> <span class="s1">&#39;no_noise_replace&#39;</span>
            <span class="n">upper_iris</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">lower_iris</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Determine if the user wants to run 2D correlation on the whole iris</span>
        <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Fulliris</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="c1"># Set the transform mode and quantify torsion</span>
            <span class="c1"># TODO: Pass the blinks list in here</span>
            <span class="n">transform_mode</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span>
            <span class="n">window_theta</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">segment_theta</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># TODO: pass the segment removal</span>
            <span class="n">torsion</span><span class="p">,</span> <span class="n">torsion_derivative</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar_transform_list</span> <span class="o">=</span> <span class="n">tq2dx</span><span class="o">.</span><span class="n">quantify_torsion</span><span class="p">(</span><span class="n">RADIUS</span><span class="p">,</span>
                <span class="n">RESOLUTION</span><span class="p">,</span>
                <span class="n">torsion_mode</span><span class="p">,</span>
                <span class="n">transform_mode</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pupil_threshold</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">upper_iris</span> <span class="o">=</span> <span class="n">upper_iris</span><span class="p">,</span>
                <span class="n">lower_iris</span> <span class="o">=</span> <span class="n">lower_iris</span><span class="p">,</span>
                <span class="n">WINDOW_THETA</span> <span class="o">=</span> <span class="n">window_theta</span><span class="p">,</span>
                <span class="n">SEGMENT_THETA</span> <span class="o">=</span> <span class="n">segment_theta</span><span class="p">,</span>
                <span class="n">calibration_frame</span> <span class="o">=</span> <span class="p">(</span><span class="n">measure_state</span><span class="o">.</span><span class="n">calibration_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
                <span class="n">calibration_angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">measure_state</span><span class="o">.</span><span class="n">calibration_angle</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>

            <span class="c1"># Construct metadata</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="s1">&#39;Mode: </span><span class="si">%(torsion_mode)s</span><span class="s1">, Iris: </span><span class="si">%(transform_mode)s</span><span class="s1">, </span><span class="si">%(replace_status)s</span><span class="s1">, Radial Thickness (pix): </span><span class="si">%(radial_thickness)d</span><span class="s1">, Video Path: </span><span class="si">%(video_path)s</span><span class="s1">, Video FPS: </span><span class="si">%(video_fps)s</span><span class="s1">&#39;</span> <span class="o">%</span> \
                            <span class="p">{</span><span class="s2">&quot;torsion_mode&quot;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span> <span class="s2">&quot;transform_mode&quot;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span> <span class="s2">&quot;replace_status&quot;</span><span class="p">:</span> <span class="n">replace_status</span><span class="p">,</span> <span class="s2">&quot;radial_thickness&quot;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="s2">&quot;video_path&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="s2">&quot;video_fps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">fps</span><span class="p">}</span>
            <span class="n">metadata_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mode&#39;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span>
                             <span class="s1">&#39;Iris&#39;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span>
                             <span class="s1">&#39;Replace&#39;</span><span class="p">:</span> <span class="n">replace_status</span><span class="p">,</span>
                             <span class="s1">&#39;Thickness&#39;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                             <span class="s1">&#39;Video&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                             <span class="s1">&#39;VIDEO_FPS&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
                             <span class="s1">&#39;REFERENCE_FRAME&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()}</span>
            <span class="c1"># Construct legend entry, which is a subset of the metadata</span>
            <span class="n">legend_entry</span> <span class="o">=</span> <span class="s1">&#39;Mode-</span><span class="si">%(torsion_mode)s</span><span class="s1">_Iris-</span><span class="si">%(transform_mode)s</span><span class="s1">_</span><span class="si">%(replace_status)s</span><span class="s1">&#39;</span> <span class="o">%</span> \
                            <span class="p">{</span><span class="s2">&quot;torsion_mode&quot;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span> <span class="s2">&quot;transform_mode&quot;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span> <span class="s2">&quot;replace_status&quot;</span><span class="p">:</span> <span class="n">replace_status</span><span class="p">}</span>
            <span class="c1"># Append torsion to the list as a tuple with the first element the results, second element as the metadata, third element as the legend entry</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">torsion</span><span class="p">,</span> <span class="n">torsion_derivative</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">legend_entry</span><span class="p">))</span>

            <span class="c1"># Initialize data object and append it to session list</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">),</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">torsion_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">torsion_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">torsion_data</span> <span class="ow">in</span> <span class="n">torsion</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">torsion</span> <span class="o">=</span> <span class="n">torsion_data</span><span class="p">,</span> <span class="n">start_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">pupil_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_dict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

         <span class="c1"># Determine if the user wants to run 2D correlation on subset and full iris</span>
        <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">AlternateFullSubset</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="c1"># Extract gui state values required for the subset method</span>
            <span class="n">transform_mode</span> <span class="o">=</span> <span class="s1">&#39;alternate&#39;</span>
            <span class="c1"># Extract gui state values required for the subset method</span>
            <span class="n">feature_coordinates</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">feature_coordinates</span>
            <span class="c1"># Run algo</span>
            <span class="n">torsion</span><span class="p">,</span> <span class="n">torsion_derivative</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar_transform_list</span> <span class="o">=</span> <span class="n">tq2dx</span><span class="o">.</span><span class="n">quantify_torsion</span><span class="p">(</span><span class="n">RADIUS</span><span class="p">,</span>
                <span class="n">RESOLUTION</span><span class="p">,</span>
                <span class="n">torsion_mode</span><span class="p">,</span>
                <span class="n">transform_mode</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pupil_threshold</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">upper_iris</span><span class="o">=</span><span class="n">upper_iris</span><span class="p">,</span>
                <span class="n">lower_iris</span><span class="o">=</span><span class="n">lower_iris</span><span class="p">,</span>
                <span class="n">WINDOW_THETA</span><span class="o">=</span><span class="n">measure_state</span><span class="o">.</span><span class="n">window_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">SEGMENT_THETA</span><span class="o">=</span><span class="n">measure_state</span><span class="o">.</span><span class="n">segment_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                <span class="n">feature_coords</span> <span class="o">=</span> <span class="n">feature_coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">calibration_frame</span> <span class="o">=</span> <span class="p">(</span><span class="n">measure_state</span><span class="o">.</span><span class="n">calibration_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span> <span class="c1">#Should it be self?</span>
                <span class="n">calibration_angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">measure_state</span><span class="o">.</span><span class="n">calibration_angle</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>
            <span class="c1"># Construct metadata</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="s1">&#39;Mode: </span><span class="si">%(torsion_mode)s</span><span class="s1">, Iris: </span><span class="si">%(transform_mode)s</span><span class="s1">, </span><span class="si">%(replace_status)s</span><span class="s1">, Radial Thickness (pix): </span><span class="si">%(radial_thickness)d</span><span class="s1">, Video Path: </span><span class="si">%(video_path)s</span><span class="s1">, Video FPS: </span><span class="si">%(video_fps)s</span><span class="s1">&#39;</span> <span class="o">%</span> \
                            <span class="p">{</span><span class="s2">&quot;torsion_mode&quot;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span> <span class="s2">&quot;transform_mode&quot;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span> <span class="s2">&quot;replace_status&quot;</span><span class="p">:</span> <span class="n">replace_status</span><span class="p">,</span> <span class="s2">&quot;radial_thickness&quot;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="s2">&quot;video_path&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="s2">&quot;video_fps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">fps</span><span class="p">}</span>
            <span class="n">metadata_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mode&#39;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span>
                             <span class="s1">&#39;Iris&#39;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span>
                             <span class="s1">&#39;Replace&#39;</span><span class="p">:</span> <span class="n">replace_status</span><span class="p">,</span>
                             <span class="s1">&#39;Thickness&#39;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                             <span class="s1">&#39;Video&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                             <span class="s1">&#39;VIDEO_FPS&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
                             <span class="s1">&#39;REFERENCE_FRAME&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()}</span>
            <span class="c1"># Construct legend entry, which is a subset of the metadata</span>
            <span class="n">legend_entry</span> <span class="o">=</span> <span class="s1">&#39;Mode-</span><span class="si">%(torsion_mode)s</span><span class="s1">_Iris-</span><span class="si">%(transform_mode)s</span><span class="s1">_</span><span class="si">%(replace_status)s</span><span class="s1">&#39;</span> <span class="o">%</span> \
                            <span class="p">{</span><span class="s2">&quot;torsion_mode&quot;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span> <span class="s2">&quot;transform_mode&quot;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span> <span class="s2">&quot;replace_status&quot;</span><span class="p">:</span> <span class="n">replace_status</span><span class="p">}</span>
            <span class="c1"># Append torsion to the list as a tuple with the first element the results, second element as the metadata, third element as the legend entry</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">torsion</span><span class="p">,</span> <span class="n">torsion_derivative</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">legend_entry</span><span class="p">))</span>

            <span class="c1"># Initialize data object and append it to session list</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">),</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">torsion_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">torsion_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">torsion_data</span> <span class="ow">in</span> <span class="n">torsion</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
            <span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">torsion</span> <span class="o">=</span> <span class="n">torsion_data</span><span class="p">,</span> <span class="n">start_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">pupil_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_dict</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1"># Determine if the user wants to run 2D correlation on a subset of the iris</span>
        <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Subset</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="c1"># Set the transform mode to subset</span>
            <span class="n">transform_mode</span> <span class="o">=</span> <span class="s1">&#39;subset&#39;</span>
            <span class="c1"># Extract gui state values required for the subset method</span>
            <span class="n">feature_coordinates</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">feature_coordinates</span>
            <span class="c1"># Run the algorithm for each set of recorded feature coordinates</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">coords</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feature_coordinates</span><span class="p">):</span>
                <span class="n">torsion_i</span><span class="p">,</span> <span class="n">torsion_derivative_i</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar_transform_list</span> <span class="o">=</span> <span class="n">tq2dx</span><span class="o">.</span><span class="n">quantify_torsion</span><span class="p">(</span><span class="n">RADIUS</span><span class="p">,</span>
                    <span class="n">RESOLUTION</span><span class="p">,</span>
                    <span class="n">torsion_mode</span><span class="p">,</span>
                    <span class="n">transform_mode</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pupil_threshold</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="n">WINDOW_THETA</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">window_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="n">SEGMENT_THETA</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">segment_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                    <span class="n">feature_coords</span> <span class="o">=</span> <span class="n">coords</span><span class="p">,</span>
                    <span class="n">calibration_frame</span> <span class="o">=</span> <span class="p">(</span><span class="n">measure_state</span><span class="o">.</span><span class="n">calibration_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">),</span>
                    <span class="n">calibration_angle</span> <span class="o">=</span> <span class="p">(</span><span class="n">measure_state</span><span class="o">.</span><span class="n">calibration_angle</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">if</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span><span class="p">))</span>


                <span class="c1"># Construct metadata</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="s1">&#39;Mode: </span><span class="si">%(torsion_mode)s</span><span class="s1">, Iris: </span><span class="si">%(transform_mode)s</span><span class="s1">, Window Theta (deg): </span><span class="si">%(window_theta)d</span><span class="s1">, Segment Theta (deg): </span><span class="si">%(segment_theta)d</span><span class="s1">, Radial Thickness (pix): </span><span class="si">%(radial_thickness)d</span><span class="s1">, Feature Number: </span><span class="si">%(feature_num)d</span><span class="s1">, Video Path: </span><span class="si">%(video_path)s</span><span class="s1">, Video FPS: </span><span class="si">%(video_fps)d</span><span class="s1">&#39;</span> <span class="o">%</span> \
                            <span class="p">{</span><span class="s2">&quot;torsion_mode&quot;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span> <span class="s2">&quot;transform_mode&quot;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span><span class="s2">&quot;window_theta&quot;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">window_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="s2">&quot;segment_theta&quot;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">segment_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="s2">&quot;radial_thickness&quot;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="s2">&quot;feature_num&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="s2">&quot;video_path&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span><span class="s2">&quot;video_fps&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">fps</span><span class="p">}</span>
                <span class="n">metadata_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mode&#39;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span>
                                 <span class="s1">&#39;Iris&#39;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span>
                                 <span class="s1">&#39;Window(deg)&#39;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">window_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                                 <span class="s1">&#39;Segment(deg)&#39;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">segment_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                                 <span class="s1">&#39;Feature Number&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                                 <span class="s1">&#39;Thickness&#39;</span><span class="p">:</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                                 <span class="s1">&#39;Video&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
                                 <span class="s1">&#39;VIDEO_FPS&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">fps</span><span class="p">,</span>
                                 <span class="s1">&#39;REFERENCE_FRAME&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">reference_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()}</span>
                <span class="c1"># Construct legend entry, which is a subset of the metadata</span>
                <span class="n">legend_entry</span> <span class="o">=</span> <span class="s1">&#39;Mode: </span><span class="si">%(torsion_mode)s</span><span class="s1">, Iris: </span><span class="si">%(transform_mode)s</span><span class="s1">, Feature Number: </span><span class="si">%(feature_num)d</span><span class="s1">&#39;</span> <span class="o">%</span> \
                            <span class="p">{</span><span class="s2">&quot;torsion_mode&quot;</span><span class="p">:</span> <span class="n">torsion_mode</span><span class="p">,</span> <span class="s2">&quot;transform_mode&quot;</span><span class="p">:</span> <span class="n">transform_mode</span><span class="p">,</span> <span class="s2">&quot;feature_num&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)}</span>
                <span class="c1"># Append torsion to the list as a tuple with the first element the results, second element as the metadata, third element as the legend entry</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">torsion_i</span><span class="p">,</span> <span class="n">torsion_derivative_i</span><span class="p">,</span> <span class="n">metadata_dict</span><span class="p">,</span> <span class="n">legend_entry</span><span class="p">))</span>

                <span class="c1"># Initialize data object and append it to session list</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">),</span><span class="n">path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
                <span class="n">torsion_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">torsion_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">torsion_data</span> <span class="ow">in</span> <span class="n">torsion_i</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
                <span class="n">data</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">torsion</span> <span class="o">=</span> <span class="n">torsion_data</span><span class="p">,</span> <span class="n">start_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">pupil_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata_dict</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.show_frame"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.show_frame">[docs]</a>    <span class="k">def</span> <span class="nf">show_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cont</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Display a frame.</span>

<span class="sd">        Inputs:</span>
<span class="sd">            cont - index of frame to display</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frames</span><span class="p">[</span><span class="n">cont</span><span class="p">]</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">tkraise</span><span class="p">()</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.set_video_path"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.set_video_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_video_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set the path of the video.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">video_path</span> <span class="o">=</span> <span class="n">askopenfilename</span><span class="p">(</span><span class="n">initialdir</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Select Video file&quot;</span><span class="p">,</span><span class="n">filetypes</span> <span class="o">=</span> <span class="p">((</span><span class="s2">&quot;AVI files&quot;</span><span class="p">,</span><span class="s2">&quot;*.avi&quot;</span><span class="p">),(</span><span class="s2">&quot;all files&quot;</span><span class="p">,</span><span class="s2">&quot;*.*&quot;</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">video_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">video_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">Video</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video_path</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">))</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.set_save_path"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.set_save_path">[docs]</a>    <span class="k">def</span> <span class="nf">set_save_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set desired path to save the torsion results to.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">save_path</span> <span class="o">=</span> <span class="n">askdirectory</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select A Folder&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_path</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="n">dat</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">save_path</span></div>


<div class="viewcode-block" id="OcularTorsionApplication.save_results"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.save_results">[docs]</a>    <span class="k">def</span> <span class="nf">save_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Save the output of the torsion results to a CSV</span>

<span class="sd">        Inputs:</span>
<span class="sd">            data - data object storing the torsion results</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="n">data</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.scroll_frames"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.scroll_frames">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Scroll through video frames.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">scroll</span><span class="o">.</span><span class="n">frame_scroll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.scroll_eyelids"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.scroll_eyelids">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_eyelids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Scroll through video frames while overlaying the eyelid.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span><span class="p">:</span>
            <span class="n">scroll</span><span class="o">.</span><span class="n">eyelid_scroll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.scroll_pupil"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.scroll_pupil">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_pupil</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Scroll through video frames while overlaying the pupil.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">:</span>
            <span class="n">scroll</span><span class="o">.</span><span class="n">pupil_scroll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.scroll_polar_transform"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.scroll_polar_transform">[docs]</a>    <span class="k">def</span> <span class="nf">scroll_polar_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar_transform_list</span><span class="p">:</span>
            <span class="n">scroll</span><span class="o">.</span><span class="n">polar_transform_scroll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar_transform_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.view_axis_rotation"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.view_axis_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">view_axis_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Scroll through the video while overlaying the pupil and a set of axis that rotate with torsion results.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="p">:</span>
            <span class="n">last_run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">scroll</span><span class="o">.</span><span class="n">torsion_scroll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span><span class="n">last_run</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.view_window_rotation"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.view_window_rotation">[docs]</a>    <span class="k">def</span> <span class="nf">view_window_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measure_state</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Scroll through the video while overlaying the pupil and the window that rotates with the torsion results.</span>

<span class="sd">        Inputs:</span>
<span class="sd">            theta_window - tuple that stores the minimum and maximum angle above/below the feature</span>
<span class="sd">            WINDOW_RADIUS - radial thickness of the window</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="p">:</span>
            <span class="n">last_run</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">feature_coords</span> <span class="o">=</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">feature_coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">feature_r</span><span class="p">,</span> <span class="n">feature_theta</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">get_polar_coord</span><span class="p">(</span><span class="n">feature_coords</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span> <span class="n">feature_coords</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()])</span>
            <span class="n">reference_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">feature_theta</span> <span class="o">-</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">window_theta</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">feature_theta</span> <span class="o">+</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">window_theta</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="n">scroll</span><span class="o">.</span><span class="n">window_scroll</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">,</span><span class="n">last_run</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">reference_bounds</span><span class="p">,</span> <span class="n">measure_state</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">.</span><span class="n">get</span><span class="p">())</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.plot_torsion"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.plot_torsion">[docs]</a>    <span class="k">def</span> <span class="nf">plot_torsion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        plots all series within the torsion list in a plotly window. The legend shows all the legend entry relating to each series.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Set up subplots</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                  <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                  <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Rotation Angle Compared to Reference Frame&#39;</span><span class="p">,</span> <span class="s1">&#39;Rotation Angle Compared to Previous Frame&#39;</span><span class="p">))</span>

        <span class="c1"># Plot rotation from reference to reference frame</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">torsion</span><span class="p">):</span>
            <span class="p">(</span><span class="n">torsion</span><span class="p">,</span> <span class="n">torsion_derivative</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">legend_entry</span><span class="p">)</span> <span class="o">=</span> <span class="n">vals</span>
            <span class="c1">#index = self.torsion.index((torsion, torsion_derivative, metadata, legend_entry))</span>
            <span class="n">x_i</span><span class="p">,</span> <span class="n">y_i</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">torsion</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="n">dx_i</span><span class="p">,</span> <span class="n">dy_i</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">torsion_derivative</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_i</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y_i</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">legend_entry</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">DEFAULT_PLOTLY_COLORS</span><span class="p">[</span><span class="n">index</span><span class="p">]))</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">append_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dx_i</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">dy_i</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">legend_entry</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">DEFAULT_PLOTLY_COLORS</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">append_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Customize titles</span>
        <span class="n">fig</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;xaxis1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frame Number&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;xaxis2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Frame Number&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;yaxis1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rotation (deg)&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">][</span><span class="s1">&#39;yaxis2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rotation (deg)&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">[</span><span class="s1">&#39;layout&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Iris Rotation History&#39;</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.construct_pupil_list"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.construct_pupil_list">[docs]</a>    <span class="k">def</span> <span class="nf">construct_pupil_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measure_torsion_button</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructs a list of pupils.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">construct_pupil_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_threshold</span><span class="o">.</span><span class="n">get</span><span class="p">())</span></div>

<div class="viewcode-block" id="OcularTorsionApplication.identify_eyelids"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.identify_eyelids">[docs]</a>    <span class="k">def</span> <span class="nf">identify_eyelids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Identifies the eyelids and blinks</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">():</span><span class="bp">self</span><span class="o">.</span><span class="n">end_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()])):</span>
                <span class="n">frame_loc</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="c1"># check if a pupil exists</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span>  <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">eyelid</span><span class="o">.</span><span class="n">detect_eyelid</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span> <span class="o">=</span> <span class="n">eyelid</span><span class="o">.</span><span class="n">pupil_obstruct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">pupil_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">eyelid_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="p">[</span><span class="n">frame_loc</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="OcularTorsionApplication.identify_blinks"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.OcularTorsionApplication.identify_blinks">[docs]</a>    <span class="k">def</span> <span class="nf">identify_blinks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Identifies the blinks.</span>
<span class="sd">        If it is a blink, insert 1. If not blink, insert 0. Else, None.</span>
<span class="sd">        Print blink locations</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Search for indices where there is a blink or a None -- pupil/eyelid not found</span>
        <span class="n">filtered_blinks</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blink_list</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">1</span><span class="p">}</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Blinks occur at frames: &#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filtered_blinks</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span></div></div>

        
<div class="viewcode-block" id="StartPage"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.StartPage">[docs]</a><span class="k">class</span> <span class="nc">StartPage</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Main menu of the torsion application. Allows users to set the video path, set the save path, preview the video and select a torsion quantification</span>
<span class="sd">    method.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">controller</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a main menu.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">title_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Main Menu&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">title_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">measure_torsion_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Measure Torsion&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">show_frame</span><span class="p">(</span><span class="n">MeasureTorsion</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measure_torsion_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">vid_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Set Video Path&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span>  <span class="n">controller</span><span class="o">.</span><span class="n">set_video_path</span><span class="p">())</span>
        <span class="n">vid_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">video_path_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">controller</span><span class="o">.</span><span class="n">video_path</span><span class="p">)</span>
        <span class="n">video_path_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="n">scroll_vid_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Preview Video&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">scroll_frames</span><span class="p">())</span>
        <span class="n">scroll_vid_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">save_path_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Set Results Save Path&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">set_save_path</span><span class="p">())</span>
        <span class="n">save_path_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">save_path_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">controller</span><span class="o">.</span><span class="n">save_path</span><span class="p">)</span>
        <span class="n">save_path_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">start_frame_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Start Frame Number:&quot;</span><span class="p">)</span>
        <span class="n">start_frame_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">start_frame_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">start_frame</span><span class="p">)</span>
        <span class="n">start_frame_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">reference_frame_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Reference Frame Number:&#39;</span><span class="p">)</span>
        <span class="n">reference_frame_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">reference_frame_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">reference_frame</span><span class="p">)</span>
        <span class="n">reference_frame_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">end_frame_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;End Frame Number:&quot;</span><span class="p">)</span>
        <span class="n">end_frame_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">end_frame_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">end_frame</span><span class="p">)</span>
        <span class="n">end_frame_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">pupil_threshold_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Pupil Detection Threshold:&quot;</span><span class="p">)</span>
        <span class="n">pupil_threshold_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">pupil_threshold_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">pupil_threshold</span><span class="p">)</span>
        <span class="n">pupil_threshold_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">pupil_loc_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Construct Pupil List&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">construct_pupil_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measure_torsion_button</span><span class="p">))</span>
        <span class="n">pupil_loc_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">pupil_scroll_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Preview Pupil Locations&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">scroll_pupil</span><span class="p">())</span>
        <span class="n">pupil_scroll_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">identify_eyelids_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Identify Eyelids&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">identify_eyelids</span><span class="p">())</span>
        <span class="n">identify_eyelids_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">scroll_eyelids_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Preview Eyelids&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">scroll_eyelids</span><span class="p">())</span>
        <span class="n">scroll_eyelids_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">identify_blinks_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Identify Blinks&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">identify_blinks</span><span class="p">())</span>
        <span class="n">identify_blinks_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span></div>


<div class="viewcode-block" id="MeasureTorsion"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.MeasureTorsion">[docs]</a><span class="k">class</span> <span class="nc">MeasureTorsion</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Measurement page of the torsion application.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        Interpolation:</span>
<span class="sd">            Integer</span>
<span class="sd">            A value of 1 indicates interpolation will be used.</span>
<span class="sd">            A value of 0 indicates interpolation will not be used.</span>

<span class="sd">        Upsampling:</span>
<span class="sd">            Integer</span>
<span class="sd">            A value of 1 indicates upsampling will be used.</span>
<span class="sd">            A value of 0 indicates upsampling will not be used.</span>

<span class="sd">        Fulliris:</span>
<span class="sd">            Integer</span>
<span class="sd">            A value of 1 indicates that correlation will be performed on the whole iris.</span>
<span class="sd">            A value of 0 indicates that correlation will be performed on a subset of the iris.</span>

<span class="sd">        Subset:</span>
<span class="sd">            Integer</span>
<span class="sd">            A value of 1 indicates that correlation will be performed on a subset of the iris.</span>
<span class="sd">            A value of 0 indicates that correlation will be performed on the whole iris.</span>

<span class="sd">        NoiseReplacement:</span>
<span class="sd">            Integer</span>
<span class="sd">            A value of 1 indicates that portions of the iris will be replaced with noise.</span>
<span class="sd">            A value of 0 indicates that no replacement on the iris will be performed</span>

<span class="sd">        radial_thickness:</span>
<span class="sd">            Integer</span>
<span class="sd">            Radial thickenss of the iris</span>

<span class="sd">        upper_iris_occ:</span>
<span class="sd">            dictionary, {&#39;c&#39;: column index, &#39;r&#39;: row index}</span>
<span class="sd">            Holds the [row,column] coordinates of the upper boundary of the iris that is not occluded by eyelids or eyelashes.</span>

<span class="sd">        lower_iris_occ:</span>
<span class="sd">            dictionary, {&#39;c&#39;: column index, &#39;r&#39;: row index}</span>
<span class="sd">            Holds the [row,column] coordinates of the lower boundary of the iris that is not occluded by eyelids or eyelashes.</span>

<span class="sd">        resolution:</span>
<span class="sd">            Double</span>
<span class="sd">            If upsampling is used, resolution gives the degree of upsampling used during the iris transform.</span>
<span class="sd">            If interpolation is used, iris transform is performed using a transform resolution of 1deg/pixel and interpolated at increments given by resolution.</span>

<span class="sd">        calibration_frame:</span>
<span class="sd">            Integer</span>
<span class="sd">            (Optional) the to use for calibration</span>

<span class="sd">        calibration_angle:</span>
<span class="sd">            Double</span>
<span class="sd">            (Optional) the angle the eye is rotated in the calibration frame</span>

<span class="sd">        feature_coordinates:</span>
<span class="sd">            List of dictionaries, {&#39;c&#39;: column index, &#39;r&#39;: row index}</span>
<span class="sd">            Holds the dictionaries of feature coordinates tracked during subset correlation.</span>

<span class="sd">        num_features:</span>
<span class="sd">            Integer</span>
<span class="sd">            size of the feature_coordinates list.</span>

<span class="sd">        window_theta:</span>
<span class="sd">            Integer</span>
<span class="sd">            Angle bounds above/below the feature that define the portion of the iris that is to be included in the reference iris window. This window should be smaller than the segment.</span>

<span class="sd">        segment_theta:</span>
<span class="sd">            Integer</span>
<span class="sd">            Angle bounds above/below the feature that define the portion of the iris that is to be included in each segment, for which the window is to be located in.</span>



<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">controller</span><span class="p">):</span>

        <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Interpolation</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Upsampling</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Subset</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Calibrate</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">NoiseReplacement</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="c1"># Run both subset and full iris</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FullandSubset</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="c1"># Run subset and Full iris alternatively</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AlternateFullSubset</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>


        <span class="c1"># Thickness, beyond the pupil edge of both the iris segment and window.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radial_thickness</span><span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="c1"># The [row,column] coordinates of point on the boundary of visible iris not occluded by upper eyelid or upper eyelashes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_iris_occ</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># The [row,column] coordinates of point on the boundary of visible iris not occluded by lower eyelid or lower eyelashes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_iris_occ</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># The degree of upsampling or interpolation used in the theta axis of transform. [deg/pixel].</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>

        <span class="c1"># The to use for calibration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="c1"># The angle the eye is rotated at the calibration frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_angle</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>

        <span class="c1"># List used to store the dictionary that holds the row and column indicies of the feature coordinates.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_coordinates</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Number of features in the list of feature coordinates.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="c1"># Portion of the iris that is smaller than the segment.</span>
        <span class="c1"># Window sized portions of the segment are extracted and compared to this window.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_theta</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="c1"># Portion of the iris in which the window is searched for.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

        <span class="n">measure_torsion_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Measure Torsion&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">measure_torsion_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">main_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Back to Main Menu&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">show_frame</span><span class="p">(</span><span class="n">StartPage</span><span class="p">))</span>
        <span class="n">main_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">measurement_options_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Iris Measurement Options&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">measurement_options_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>


        <span class="n">subset_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Subset Iris&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Subset</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Subset</span><span class="o">.</span><span class="n">get</span><span class="p">())),</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">subset_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">full_iris_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Full Iris&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Subset</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span><span class="o">.</span><span class="n">get</span><span class="p">())),</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">full_iris_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">noise_replacement_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Both Subset and Full Iris&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FullandSubset</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">noise_replacement_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">noise_replacement_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Alternate Subset and Full Iris&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlternateFullSubset</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">noise_replacement_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">measurement_options_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Measurement Options&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">measurement_options_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">interpolation_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Interpolate&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Interpolation</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Upsampling</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">get</span><span class="p">())),</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">interpolation_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">upsampling_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Upsample&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Upsampling</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Interpolation</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="ow">not</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Upsampling</span><span class="o">.</span><span class="n">get</span><span class="p">())),</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">upsampling_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">calibrate_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Calibrate&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Calibrate</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">calibrate_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">noise_replacement_check</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Noise Replacement&quot;</span><span class="p">,</span> <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NoiseReplacement</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()])</span>
        <span class="n">noise_replacement_check</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">radial_thickness_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Radial Thickness (pixels):&quot;</span><span class="p">)</span>
        <span class="n">radial_thickness_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">radial_thickness</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radial_thickness</span><span class="p">)</span>
        <span class="n">radial_thickness</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">resolution_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Resolution (degree):&quot;</span><span class="p">)</span>
        <span class="n">resolution_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">resolution</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">resolution</span><span class="p">)</span>
        <span class="n">resolution</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">calibration_frame_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Calibration Frame:&quot;</span><span class="p">)</span>
        <span class="n">calibration_frame_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_frame_input</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calibration_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_frame_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">calibration_angle_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Calibration Angle (degree):&quot;</span><span class="p">)</span>
        <span class="n">calibration_angle_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_angle_input</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calibration_angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_angle_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">measurement_options_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Measurement Settings&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">measurement_options_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">segment_theta_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Iris Segment Bounds (deg):&quot;</span><span class="p">)</span>
        <span class="n">segment_theta_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">segment_theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">)</span>

        <span class="n">window_theta_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Iris Window Bounds (deg):&quot;</span><span class="p">)</span>
        <span class="n">window_theta_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">window_theta_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window_theta</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window_theta_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">)</span>

        <span class="n">num_features_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Number of features to track:&quot;</span><span class="p">)</span>
        <span class="n">num_features_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">num_features_act_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">)</span>
        <span class="n">num_features_act_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">feature_loc_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Select Feature&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_coordinates</span><span class="p">(</span><span class="n">controller</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_loc_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">feature_rec_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Record Coordinates&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">record_feature_coordinates</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_rec_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">remove_features_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Clear Clicked Values&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_coordinates</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_features_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">measurement_options_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Run and Save&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">measurement_options_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">run_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Run&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Save to CSV&#39;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">save_results</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="n">measurement_options_label</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Animate and Plot&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">LARGE_FONT</span><span class="p">)</span>
        <span class="n">measurement_options_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">view_axis_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Animate Axis Rotation&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">view_axis_rotation</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view_axis_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">view_window_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Animate Window Location&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">view_window_rotation</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view_window_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">view_torsion_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Plot Results&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">plot_torsion</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view_torsion_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">preview_polar_transform_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Preview Polar Transform&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">controller</span><span class="o">.</span><span class="n">scroll_polar_transform</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preview_polar_transform_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>


<div class="viewcode-block" id="MeasureTorsion.get_feature_coordinates"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.MeasureTorsion.get_feature_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">get_feature_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">controller</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Opens the starting video frame in a separate window so that the user can click on a prominent feature.</span>
<span class="sd">        Requires the user to separately &#39;record feature coordinates&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">clk</span><span class="o">.</span><span class="n">click_coordinates</span><span class="p">(</span><span class="n">controller</span><span class="o">.</span><span class="n">video</span><span class="p">[</span><span class="n">controller</span><span class="o">.</span><span class="n">start_frame</span><span class="o">.</span><span class="n">get</span><span class="p">()],</span> <span class="s1">&#39;Click on a distinct iris feature to track&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasureTorsion.record_feature_coordinates"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.MeasureTorsion.record_feature_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">record_feature_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Stores feature coordinates clicked on to be used in the torsion quantification method.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="n">clk</span><span class="o">.</span><span class="n">get_click_coordinates</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_coordinates</span><span class="p">)))</span></div>

<div class="viewcode-block" id="MeasureTorsion.clear_coordinates"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.MeasureTorsion.clear_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">clear_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Clear the list of features if multiple have been clicked on and recorded.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">feature_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_coordinates</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">upper_iris_occ</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_iris_occ</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lower_set_check</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;Not Set&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">upper_set_check</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;Not Set&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MeasureTorsion.update"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.MeasureTorsion.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update the GUI page to enable/disable buttons and entry fields depending on the state.</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># If correlation is to be performed on the just full iris, do not allow the user to enter parameters for the subset method.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_loc_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_rec_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>

        <span class="c1"># If correlations is to be performed on both full and subsets, then allow all fields except for noise</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FullandSubset</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_loc_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_rec_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Subset</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AlternateFullSubset</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NoiseReplacement</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># if correlation is to be performed on full and subset alternatively, then allow all fields except for noise</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">AlternateFullSubset</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_loc_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_rec_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Fulliris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Subset</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">FullandSubset</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NoiseReplacement</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># If correlation is to be performed on a subset of the iris, allow the user to enter parameters for the subset method. Also do Not</span>
        <span class="c1"># allow the user to replace portions of the iris with noise.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Subset</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">segment_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">window_theta_entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_loc_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">feature_rec_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">NoiseReplacement</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Calibrate</span><span class="o">.</span><span class="n">get</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calibration_frame_input</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calibration_angle_input</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calibration_frame_input</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calibration_angle_input</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;disabled&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="run"><a class="viewcode-back" href="../../../modules/ota.gui.html#ota.gui.torsion_application.run">[docs]</a><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">OcularTorsionApplication</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ocular Torsion Measurement&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Ocular-Torsion-Quantification</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.torsion.html">Torsion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.iris.html">ota.iris package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.pupil.html">ota.pupil package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.video.html">ota.video package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.eyelid.html">ota.eyelid package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.data.html">ota.data package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.gui.html">ota.gui package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/ota.execution.html">ota.execution package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Zara Lim, Esther Lin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>